var ComboBox=function(a,b){this.container=a,this.container.className+=" cb--container",this.input=a.getElementsByTagName("input")[0],this.input.className+=" cb--input",this.select=a.getElementsByTagName("select")[0],this.select.className+=" cb--select";var c=document.createElement("option");c.innerHTML="---",this.select.insertBefore(c,this.select.options[0]),this.options=this.select.options,this.select.value=this.options[0].innerHTML,this.select.value=[],this.input.setAttribute("aria-label","Special inputfield with "+this.options.length+" prefilled options available, use the down arrow key to chose one or write your own text."),this.select.setAttribute("aria-hidden","true"),this.addEventListeners(),this.createVisualHint(),this.hideSelect(),b||this.setStyles()};ComboBox.prototype.addEventListeners=function(){return this.input.addEventListener("focus",this.showSelect.bind(this)),this.input.addEventListener("blur",this.hideSelect.bind(this)),this.input.addEventListener("keyup",this.handleInput.bind(this)),this.select.addEventListener("focus",this.showSelect.bind(this)),this.select.addEventListener("blur",this.hideSelect.bind(this)),this.select.addEventListener("change",this.handleSelection.bind(this)),this.select.addEventListener("keypress",this.handleSelection.bind(this)),this.select.addEventListener("click",this.handleSelection.bind(this)),this},ComboBox.prototype.handleInput=function(a){var b=this.getKey(a);return"ArrowDown"===b?this.select.focus():"Escape"===b?this.hideSelect():"Enter"===b?(this.input.value=this.select.value,this.hideSelect()):this.handleWriting(a.target.value),this},ComboBox.prototype.handleWriting=function(a){var b=this.isTextInOptions(a,this.options);if(b&&""!=a)this.select.value=b;else{var c=""!=a?"--- "+a:"---";this.options[0].innerHTML=c,this.select.value=c,this.select.value=[]}return this},ComboBox.prototype.isTextInOptions=function(a,b){for(var c=1,d=b.length;c<d;c++)if(a.toLowerCase()==b[c].value.substring(0,a.length).toLowerCase())return b[c].innerHTML;return!1},ComboBox.prototype.handleSelection=function(a){var b=this.getKey(a);return"Escape"===b?(this.select.blur(),this.input.focus()):"---"!=a.target.value.substring(0,3)&&""!=a.target.value?this.input.value=a.target.value:""!=a.target.value&&(this.input.value=a.target.value.substring(4,a.target.value.length)),"Enter"===b&&(this.select.blur(),this.input.focus()),this},ComboBox.prototype.getKey=function(a){return"Enter"===a.key||"Enter"===a.code||13===a.keyCode?"Enter":"Escape"===a.key||"Escape"===a.code||27===a.keyCode?"Escape":"ArrowDown"===a.key||"ArrowDown"===a.code||40===a.keyCode?"ArrowDown":void 0},ComboBox.prototype.hideSelect=function(){return this.select.setAttribute("aria-hidden","true"),this.container.style.overflow="hidden",this.select.style.left="-9999999px",this.select.style.pointerEvents="none",this.select.style.opacity=0,this.select.tabIndex=-1,this},ComboBox.prototype.showSelect=function(){return this.select.setAttribute("aria-hidden","false"),this.container.style.overflow="visible",this.select.style.left="0",this.select.style.pointerEvents="all",this.select.style.opacity=1,this.select.tabIndex=0,this},ComboBox.prototype.createVisualHint=function(){this.hint=document.createElement("span"),this.hint.setAttribute("aria-hidden","true"),this.hint.className="cb--hint",this.hint.innerHTML="â–¼",this.container.insertBefore(this.hint,this.input)},ComboBox.prototype.setStyles=function(){this.container.style.display="inline-block",this.container.style.verticalAlign="top",this.container.style.position="relative",this.input.style.boxSizing="border-box",this.input.style.height="100%",this.input.style.width="100%",this.select.style.border="1px solid lightgrey",this.select.style.borderTop="0",this.select.style.position="absolute",this.select.style.top="100%",this.select.style.width="100%",this.hint.style.fontSize="8px",this.hint.style.pointerEvents="none",this.hint.style.position="absolute",this.hint.style.right="5%",this.hint.style.top="25%",this.select.size=4};